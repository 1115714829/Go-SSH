# 0基础开发方法辅助

面向“0基础但懂代码逻辑”的开发者，帮助你在保持 Fyne 原生桌面应用前提下，快速搭建并验证前后端分离的 Go-SSH 客户端。

## 推荐顺序
- 先把后端服务跑起来，并实现一个最小可用的“Ping”接口。
- 同时保留一个最简单的前端窗口（Fyne），加一个“连接测试”按钮验证后端。
- 以小步快跑的方式迭代：后端能回应、前端能显示结果，再逐步扩展。

## 第一阶段：准备环境
- 在项目根目录初始化 Go 模块：
  - `go mod init go-ssh`
- 拉取 Fyne 依赖：
  - `go get fyne.io/fyne/v2`
- 标准库（`encoding/json`、`net` 等）无需另外安装。

## 启动后端服务（Ping 验证）
- 运行后端：
  - `go run ./service`
- 观察日志应显示监听提示（如 `SSH Service listening on :8088`）。
- 命令行连通性测试（发送一行 JSON）：
  - `printf '{"type":"ping"}\n' | nc localhost 8088`
- 预期看到服务返回一行 JSON，例如：
  - `{"status":"ok","message":"service online"}` 或后续实现的 `{"ok":true,"data":{"message":"pong"}}`。

## 启动前端窗口（最小 Fyne 验证）
- 运行前端：
  - `go run ./client`
- 将打开一个 Fyne 窗口，初期显示占位文本。后续在窗口中添加“连接测试”按钮，点击后调用 `client/client/api_client.go`，请求后端并显示响应结果。

## 项目职责边界（牢记）
- `client/`：Fyne 原生桌面应用，只负责 UI 与轻量 API 调用；不直接持有 SSH 连接。
- `service/`：独立进程，负责 SSH 连接池、会话生命周期、配置存储、消息路由。
- `proto/`：前后端共享的数据结构与协议定义，避免重复定义。

## 可执行的小目标（循序渐进）
- 后端：
  - 将 `service/main.go` 切换为调用 `server.Start(":8088", handler)`，集中管理连接与协议路由。
  - 在 `handler` 中实现 `type=ping`，返回 `{"ok":true,"data":{"message":"pong"}}`。
  - 增加 `type=list_connections` 的空实现，返回空数组，先打通数据流。
- 前端：
  - 在主窗口加入“连接测试”按钮：点击后调用 `APIClient.Send({"type":"ping"})`，把返回的 `message` 展示到界面。
  - 加入“刷新连接列表”按钮：调用 `{"type":"list_connections"}`，把返回的列表渲染为简单的列表组件。

## 常见坑提醒
- 模块与依赖：未执行 `go mod init` 会导致 `go run` 报错；确保先初始化并拉取 Fyne。
- 消息格式：采用“每行一个 JSON”，写出时一定在末尾追加换行符 `\n`，便于服务端按行读取。
- 端口冲突：默认使用 `:8088`，若被占用，修改为其他端口并同步前端配置。

## 目录清理建议（如出现嵌套重复目录）
- 如果你看到 `client/ui/ui`、`service/config/config`、`service/data/data`、`service/ssh/ssh` 等“套娃”目录：
  - 将内部文件上移一层，如把 `client/ui/ui` 中的文件移动到 `client/ui`。
  - 删除重复的子目录，保持层级扁平。

## 后续扩展建议
- 在 `proto/message.go` 中完善协议类型：`Connect`、`Disconnect`、`Execute`、`ListConnections`、`SaveConnection` 等。
- 在 `service/ssh/` 中实现连接池与生命周期管理，结合 `service/data/` 下 JSON 持久化。
- 在 `client/ui/` 中使用标签页展示多个终端会话，逐步接入 `fyne-io/terminal`。

## 开发约定（必须）
- 必须使用 Go 语言与 Fyne 编写原生桌面应用（位于 `client/`）。
- 代码需清晰可读，关键模块与导出方法必须有注释说明用途与参数。
- 前端不直接持有 SSH 连接，所有连接的创建、复用、释放均由后端服务处理。
- 公共协议类型位于根目录 `proto` 下，禁止在前后端重复定义。

## 快速运行
- 启动后端：`go run ./service`
- 启动前端：`go run ./client`
- 用 `nc` 验证后端：`printf '{"type":"ping"}\n' | nc localhost 8088`

以上流程适合你按模块逐步实现与验证，每完成一个小目标就能看到明显反馈，从而稳步推进整体功能。
# 技术选型

- GUI框架: Fyne（跨平台、现代化、易用）
- SSH库: `golang.org/x/crypto/ssh` + `goph` 封装库
- 终端组件: `fyne-io/terminal` 提供嵌入式终端
- 数据存储: JSON 文件（由后端服务负责统一管理）

# 功能模块

- 连接管理器: 添加/编辑/删除/分类 SSH 连接
- 认证管理: 支持密码和私钥认证
- 数据持久化: 本地 JSON 文件存储配置（后端负责）
- 终端界面: 多标签 SSH 终端
- 会话管理: 连接历史记录
- 后端服务: 连接池、会话生命周期、异步数据推送

# 架构设计（保持 Fyne 原生桌面应用，前后端分离）

在保持 Fyne 原生桌面应用的前提下，采用前后端分离架构。设计一个 C/S 架构的 SSH 客户端：Fyne 作为前端界面，后端作为独立服务进程管理 SSH 连接和配置数据。

```
┌────────────────────────────┐          ┌──────────────────────────┐
│  Frontend (Fyne Desktop)   │          │  Backend (SSH Service)   │
│                            │  TCP+JSON│                          │
│  • UI界面层                │<────────>│  • SSH连接池管理         │
│  • 用户交互                │   IPC    │  • 配置文件管理          │
│  • 数据展示                │          │  • 会话生命周期管理      │
│  • 轻量级API客户端         │          │  • 异步数据推送          │
└────────────────────────────┘          └──────────────────────────┘
```

- 通信协议: 使用 IPC 的通信方式（本地 TCP + JSON），简单稳定高效。

# 目录结构规划（后端为 service，前端为 client，公共文件在根）

```
Go-SSH/
├── client/                  # 前端（Fyne 原生桌面应用）
│   ├── main.go              # Fyne 应用入口
│   ├── ui/                  # UI 组件与窗口
│   └── client/
│       └── api_client.go    # 轻量级后端通信客户端
├── service/                 # 后端服务（独立进程）
│   ├── main.go              # 服务入口
│   ├── server/
│   │   └── tcp_server.go    # TCP+JSON 服务器
│   ├── ssh/
│   │   └── manager.go       # SSH 连接管理器
│   ├── config/
│   │   └── store.go         # 配置存储
│   └── data/                # 数据文件（JSON）
└── proto/                   # 公共协议与类型（前后端共享）
    └── message.go           # 协议定义
```

# 说明与后续工作

- 前端仅负责 UI 展现与轻量 API 调用，所有连接与数据由后端统一管理。
- 后端通过本地 TCP 监听，采用 JSON 作为消息格式，便于扩展和调试。
- 协议定义与类型放在 `proto/message.go`，前后端共享同一套消息模型。
- 随项目推进，可在 README 中补充 API 列表（如 Connect、Disconnect、Execute、ListConnections、SaveConnection 等）。

## 开发约定（必须）

- 必须使用 Go 语言与 Fyne 编写原生桌面应用（client 目录）。
- 代码需清晰可读，关键模块与导出方法必须有注释说明用途与参数。
- 前端不直接持有 SSH 连接，所有连接的创建、复用、释放均由后端服务处理。
- 通信采用本地 TCP + JSON 的 IPC 方式，消息一行一个 JSON（便于解析与调试）。
- 公共协议类型位于根目录 `proto` 下，禁止在前后端重复定义。

## 运行指南（示例）

- 启动后端服务：`go run ./service`
- 启动前端客户端：`go run ./client`
- 修改端口或存储路径：在 `service` 中调整监听地址与配置存储实现。